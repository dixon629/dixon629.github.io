<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hui&#39;s blog</title>
  <meta name="author" content="Hui">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Hui&#39;s blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Hui&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Hui&#39;s blog</a></h1>
  <h2><a href="/">Make progress a little bit every day</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/abouts.html">About</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-03T13:33:35.000Z"><a href="/2015/04/03/add-customized-button-text-angularjs-dropdown-mulitipselect/">2015-04-03</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/03/add-customized-button-text-angularjs-dropdown-mulitipselect/">Customize button text for angularjs-dropdown-mulitipselect</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Recently I was using <a href="https://github.com/dotansimha/angularjs-dropdown-multiselect" target="_blank" rel="external">angularjs-dropdown-multiselect</a> for multiple select. It’s a good library, but it doesn’t support customizing button text very well, so I forked it and added the customized button text feature.<br>The forked repository is <a href="https://github.com/dixon629/angularjs-dropdown-multiselect" target="_blank" rel="external">https://github.com/dixon629/angularjs-dropdown-multiselect</a>.<br>It’s easy to use it, just specify <strong>buttonTextFunction</strong> in the <strong>extraSettings</strong>.<br>It passes three parameters: <em>options</em>, <em>selectedModel</em>, <em>settings</em></p>
<ol>
<li><strong>options</strong>: the data provider of dropdown list</li>
<li><strong>selectedModel</strong>: the selected model of dropdown list</li>
<li><strong>settings</strong>: the settings of dropdown list</li>
</ol>
<p>This is a demo: how to display “All” when you check the all items for the dropdown<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dropdownButtonTextFunction</span><span class="params">(options,selectedModel,settings)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(selectedModel &amp;&amp; selectedModel.length == options.length)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'All'</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> selectedModel.length+<span class="string">' checked'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$scope.myExtraSettings = &#123;buttonTextFunction: dropdownButtonTextFunction&#125;;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-03T11:57:34.000Z"><a href="/2015/04/03/How-to-download-file-on-NET-OWIN/">2015-04-03</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/03/How-to-download-file-on-NET-OWIN/">How to download file on .NET OWIN</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Sometimes we need to use browser navigation or iframe mechanism to download file as some old browsers don’t support html5 file API.<br>But there’s a problem that most of applications has access control, thus you can’t access the server source directly.<br><strong>How to do it on .NET OWIN?</strong><br>My solution is to append access token to parameters of http request, then parse the token and wrap it to header of http request on the server-side.<br>The code snippet in the StartUp.Auth.cs<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (context.Request.QueryString.HasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrWhiteSpace(context.Request.Headers.Get(<span class="string">"Authorization"</span>)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> queryString = HttpUtility.ParseQueryString(context.Request.QueryString.Value);</span><br><span class="line">            <span class="keyword">string</span> token = queryString.Get(<span class="string">"accessToken"</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">string</span>.IsNullOrWhiteSpace(token))</span><br><span class="line">            &#123;</span><br><span class="line">                context.Request.Headers.Add(<span class="string">"Authorization"</span>, <span class="keyword">new</span>[] &#123; <span class="keyword">string</span>.Format(<span class="string">"Bearer &#123;0&#125;"</span>, token) &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">await</span> next.Invoke();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-03-31T18:18:22.000Z"><a href="/2015/03/31/ESL-1090-Speaking-About-the-Future/">2015-03-31</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/31/ESL-1090-Speaking-About-the-Future/">ESL_1090 Speaking About the Future</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="1-_futuristic">1. futuristic</h3><p>adj.of or relating to the future<br><em>These designs are really <strong>futuristic- looking.</strong></em></p>
<h3 id="2-_forward-thinking">2. forward-thinking</h3><p>planning or tending to plan for the future; forward-looking.</p>
<h3 id="3-_space-age">3. space-age</h3><p>the period in modern history characterized by space exploration, usually considered as beginning October 4, 1957, when the Soviet Union launched the first artificial satellite, Sputnik I, into orbit around the earth.</p>
<h3 id="4-_gadget">4. gadget</h3><p>a small mechanical device or appliance</p>
<h3 id="5-_evolution">5. evolution</h3><p>any process of formation or growth; development</p>
<h3 id="6-_labor-saving">6. labor-saving</h3><p>designed or intended to reduce or replace human labor </p>
<h3 id="7-_artificial">7. artificial</h3><p>made by human skill; produced by humans (opposed to natural )<br><em>artificial intelligence</em> 人工智能</p>
<h3 id="8-_impersonal">8. impersonal</h3><p>lacking human emotion or warmth</p>
<h3 id="9-_have_a_fear_of_the_unknown">9. have a fear of the unknown</h3><h3 id="10-_in_a_nutshell">10. in a nutshell</h3><p>in a nutshell, in very brief form; in a few words:<br><em>Just tell me the story in a nutshell.</em></p>
<h3 id="11-_sanitation">11. sanitation</h3><p>卫生系统或设备</p>
<h3 id="12-_time_travel">12. time travel</h3><p>hypothetical transport through time into the past or the future.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-03-29T17:46:58.000Z"><a href="/2015/03/29/ESL-1089-Unconventional-Marriages/">2015-03-29</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/29/ESL-1089-Unconventional-Marriages/">ESL_1089 Unconventional Marriages</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="1-_have_been_dating_for_over_a_year">1. have been dating for over a year</h3><p>已经交往一年多了，交往可以用 <em>date</em></p>
<h3 id="2-_tie_the_knot">2. tie the knot</h3><p>[法] 结婚,<em>tie现在分词 <strong>tying</strong></em></p>
<h3 id="3-_open-minded">3. open-minded</h3><p>adj.虚心的； 思想开明的； 无先入之见的； 无偏见的</p>
<h3 id="4-_polygamy">4. polygamy</h3><p>n.多配偶（制），一夫多妻（制）或一妻多夫（制）； 多妻制； 多偶制； 一夫多妻制 </p>
<h3 id="5-_spouse">5. spouse</h3><p>n.配偶</p>
<h3 id="6-_picture/image">6. picture/image</h3><p>“想象”的意思</p>
<h3 id="7-_somehow">7. somehow</h3><p>adv.以某种方式，用某种方法； &lt;非正&gt;不知怎么地，不知道怎样，不晓得什么缘故； 设法，想办法，想个方法； 莫明其妙地</p>
<p><em>Somehow, he’d managed to persuade Kay to buy one for him.</em><br><em>不知用了什么方法，他成功说服凯给他买了一个。</em></p>
<h3 id="8-_arranged_marriage">8. arranged marriage</h3><p>n.包办婚姻</p>
<h3 id="9-_May-December_romances">9. May-December romances</h3><p>老夫少妻或者老妻少夫</p>
<h3 id="10-_Am_I_missing_something?">10. Am I missing something?</h3><p>我错过什么吗？<em>常用口语</em></p>
<h3 id="11-_cohabit">11. cohabit</h3><p>vi.（未婚者）同居</p>
<h3 id="12-_What_are_differents_between:_fear,_scare,_afraid_and_frighten?">12. What are differents between: fear, scare, afraid and frighten?</h3><p>Fear is a noun and is what you feel when you are scared or uneasy about something:<br>I have a fear of heights. </p>
<p>Scare and Frighten are verbs and usually mean the same thing, to cause fear in something or someone:<br>It really frightened me to be up on that ladder. Or, heights really scare me.</p>
<p>Afraid is an adjective and is how you feel when you are scared:<br>I am afraid of heights.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-03-28T12:41:23.000Z"><a href="/2015/03/28/svg-to-png/">2015-03-28</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/28/svg-to-png/">How to export nvd3 chart to PNG</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Recently I was working on NVD3. I got a task to export <a href="https://github.com/novus/nvd3" target="_blank" rel="external">nvd3</a> chart to PNG file.<br>It needs to support IE9+, Chrome, Firefox. I encountered some problems when I was doing this task, it took me some time to figure it out. I think it is better to share my experience for who has similar requirements.<br><em>nvd3</em> is base on <a href="http://d3js.org/" target="_blank" rel="external">d3js</a>. <em>d3js</em> uses SVG to render data. So the key issue is how to covert SVG to PNG, and the other issue is how to download the PNG file.</p>
<h2 id="Solution_1:_send_SVG_to_Server_,_convert_it_to_PNG_and_generate_link_to_download">Solution 1: send SVG  to Server , convert it to PNG and generate link to download</h2><p>Our server-side is Asp.net, so I did some research how to convert SVG to PNG on .net. I got three options,<a href="https://github.com/vvvv/SVG" target="_blank" rel="external">SVG.NET</a>,<a href="http://imagemagick.codeplex.com/" target="_blank" rel="external"> ImageMagick.NET</a>,<a href="https://inkscape.org/" target="_blank" rel="external">inkscape</a>.<br>I tried them out, but no one can generate the PNG perfectly. The <em>nvd3</em> uses some CSS class for SVG, but <em>SVG.NET</em> and <em>mageMagick.NET</em> don’t support it very well. And the PNG file that <em>inkscape</em> generates are  different with browsers render. I tried to add the styles to SVG file manually without CSS, but PNG file they generated still looks different with browsers render.<br>Finally I found <a href="http://phantomjs.org/" target="_blank" rel="external">PhantomJs</a> out. <em>PhantomJS</em> is a headless WebKit scriptable with a JavaScript API. <em>PhantomJS</em> is a perfect solution to render SVG and can export to image and PDF. It can generate PNG exactly same with browsers render. But I have to install it on the server and write some API to call it.<br><strong>I discussed with my leader, but she didn’t like this solution, so I have to turn to Solution 2.</strong></p>
<h2 id="Solution_2:_convert_SVG_to_html5_canvas_,_then_convert_canvas_to_PNG_and_download_it">Solution 2: convert SVG to html5 canvas , then convert canvas to PNG and download it</h2><h3 id="Step_1:_convert_SVG_to_canvas">Step 1: convert SVG to canvas</h3><p><a href="https://github.com/exupero/saveSvgAsPng" target="_blank" rel="external">saveSvgAsPng</a> is a library to export SVG to PNG on the client-side. But unfortunately, it doesn’t work on IE and safari. There is a security error on IE. And besides,It can’t download the PNG file on safari, safari open the file on the new tab instead of downloading it. So I have to give up this scenario.<br>And then I found <a href="https://github.com/gabelerner/canvg" target="_blank" rel="external">canvg</a> out, <em>canvg</em> can parse SVG and render it on Canvas. But <em>canvg </em>doesn’t support external CSS on the SVG.<br>Eventually I was inspired by the <em>saveSvgAsPng</em>. <em>saveSvgAsPng</em> will read the used external CSS for SVG and put it into the SVG. So I create a new function in <em>saveSvgAsPng</em> called <strong>saveAsSVGWithStyle</strong>.It will return a new SVG with CSS.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">out$.saveAsSVGWithStyle = <span class="function"><span class="keyword">function</span> <span class="params">(el, options, cb)</span> </span>&#123;</span><br><span class="line">      options = options || &#123;&#125;;</span><br><span class="line">      options.scale = options.scale || <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">var</span> xmlns = <span class="string">"http://www.w3.org/2000/xmlns/"</span>;</span><br><span class="line"></span><br><span class="line">      inlineImages(el, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="keyword">var</span> outer = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">          <span class="keyword">var</span> clone = el.cloneNode(<span class="literal">true</span>);</span><br><span class="line">          <span class="keyword">var</span> width, height;</span><br><span class="line">          <span class="keyword">if</span>(el.tagName == <span class="string">'svg'</span>) &#123;</span><br><span class="line">              width = <span class="built_in">parseInt</span>(clone.getAttribute(<span class="string">'width'</span>) || clone.style.width || out$.getComputedStyle(el).getPropertyValue(<span class="string">'width'</span>));</span><br><span class="line">              height = <span class="built_in">parseInt</span>(clone.getAttribute(<span class="string">'height'</span>) || clone.style.height || out$.getComputedStyle(el).getPropertyValue(<span class="string">'height'</span>));</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">var</span> box = el.getBBox();</span><br><span class="line">              width = box.x + box.width;</span><br><span class="line">              height = box.y + box.height;</span><br><span class="line">              clone.setAttribute(<span class="string">'transform'</span>, clone.getAttribute(<span class="string">'transform'</span>).replace(<span class="regexp">/translate\(.*?\)/</span>, <span class="string">''</span>));</span><br><span class="line"></span><br><span class="line">              <span class="keyword">var</span> svg = <span class="built_in">document</span>.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>,<span class="string">'svg'</span>)</span><br><span class="line">              svg.appendChild(clone)</span><br><span class="line">              clone = svg;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          clone.setAttribute(<span class="string">"version"</span>, <span class="string">"1.1"</span>);</span><br><span class="line">          clone.setAttributeNS(xmlns, <span class="string">"xmlns"</span>, <span class="string">"http://www.w3.org/2000/svg"</span>);</span><br><span class="line">          clone.setAttributeNS(xmlns, <span class="string">"xmlns:xlink"</span>, <span class="string">"http://www.w3.org/1999/xlink"</span>);</span><br><span class="line">          clone.setAttribute(<span class="string">"width"</span>, width * options.scale);</span><br><span class="line">          clone.setAttribute(<span class="string">"height"</span>, height * options.scale);</span><br><span class="line">          clone.setAttribute(<span class="string">"viewBox"</span>, <span class="string">"0 0 "</span> + width + <span class="string">" "</span> + height);</span><br><span class="line">          outer.appendChild(clone);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">var</span> css = styles(el, options.selectorRemap);</span><br><span class="line">          <span class="keyword">var</span> s = <span class="built_in">document</span>.createElement(<span class="string">'style'</span>);</span><br><span class="line">          s.setAttribute(<span class="string">'type'</span>, <span class="string">'text/css'</span>);</span><br><span class="line">          s.innerHTML = <span class="string">"&lt;![CDATA[\n"</span> + css + <span class="string">"\n]]&gt;"</span>;</span><br><span class="line">          <span class="keyword">var</span> defs = <span class="built_in">document</span>.createElement(<span class="string">'defs'</span>);</span><br><span class="line">          defs.appendChild(s);</span><br><span class="line">          clone.insertBefore(defs, clone.firstChild);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">var</span> svg = doctype + outer.innerHTML;</span><br><span class="line">          <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">              cb(svg, width,height);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>Then we can convert SVG with CSS to canvas through <em>canvg</em>.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">saveAsSVGWithStyle(svgElement.node(), &#123;&#125;, <span class="function"><span class="keyword">function</span> <span class="params">(svgWithStyle, width, height)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>);</span><br><span class="line">      canvas.width = scale * width;</span><br><span class="line">      canvas.height = scale * height;</span><br><span class="line">      canvg(canvas, svgWithStyle, &#123; scaleWidth: canvas.width, scaleHeight: canvas.height, ignoreDimensions: <span class="literal">true</span>, ignoreMouse: <span class="literal">true</span>, ignoreClear: <span class="literal">true</span> &#125;);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></p>
<p>When I tested on different browsers. I found that IE9 doesn’t support  SVG <strong>defs</strong>. So I can’t just define <em>defs and put CSS in defs</em>. I have to add style property to the SVG manually like this.<br><strong>If you have a better solution to make external CSS into the DOM style property, let me know, thank you.</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _appendStylesToSVG = <span class="function"><span class="keyword">function</span> <span class="params">(svgElement)</span> </span>&#123;</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis'</span>).style(<span class="string">'pointer-events'</span>, <span class="string">'none'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis path'</span>).style(<span class="string">'fill'</span>, <span class="string">'none'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis path'</span>).style(<span class="string">'stroke'</span>, <span class="string">'rgb(204, 204, 204)'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis path'</span>).style(<span class="string">'stroke-opacity'</span>, <span class="string">'0.75'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis path'</span>).style(<span class="string">'shape-rendering'</span>, <span class="string">'crispedges'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis path.domain'</span>).style(<span class="string">'stroke-opacity'</span>, <span class="string">'0.75'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis.nv-x path.domain'</span>).style(<span class="string">'stroke-opacity'</span>, <span class="string">'0'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis line'</span>).style(<span class="string">'fill'</span>, <span class="string">'none'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis line'</span>).style(<span class="string">'stroke'</span>, <span class="string">'rgb(229, 229, 229)'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis line'</span>).style(<span class="string">'shape-rendering'</span>, <span class="string">'crispedges'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-axis .zero line, .nvd3 .nv-axis line.zero'</span>).style(<span class="string">'stroke-opacity'</span>, <span class="string">'0.75'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-multibar .nv-groups rect'</span>).style(<span class="string">'stroke-opacity'</span>, <span class="string">'0'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-multibar .nv-groups rect'</span>).style(<span class="string">'transition'</span>, <span class="string">'fill-opacity 250ms linear 0s'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-multibarHorizontal .nv-groups rect'</span>).style(<span class="string">'stroke-opacity'</span>, <span class="string">'0'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-multibarHorizontal .nv-groups rect'</span>).style(<span class="string">'transition'</span>, <span class="string">'fill-opacity 250ms linear 0s'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-discretebar .nv-groups rect'</span>).style(<span class="string">'stroke-opacity'</span>, <span class="string">'0'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nvd3 .nv-discretebar .nv-groups rect'</span>).style(<span class="string">'transition'</span>, <span class="string">'fill-opacity 250ms linear 0s'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.nv-x .tick line'</span>).style(<span class="string">'display'</span>, <span class="string">'none'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.statistics-title'</span>).style(<span class="string">'fill'</span>, <span class="string">'rgba(107, 156, 188, 1)'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.statistics-title'</span>).style(<span class="string">'font-size'</span>, <span class="string">'21px'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.statistics-title'</span>).style(<span class="string">'font-weight'</span>, <span class="string">'300'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.statistics-title-total'</span>).style(<span class="string">'font-size'</span>, <span class="string">'14px'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.statistics-title-total'</span>).style(<span class="string">'fill'</span>, <span class="string">'rgb(153, 153, 153)'</span>);</span><br><span class="line">    svgElement.selectAll(<span class="string">'.statistics-title-total'</span>).style(<span class="string">'font-weight'</span>, <span class="string">'300'</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h3 id="Step_2:_downloading_PNG">Step 2: downloading PNG</h3><p>We have to support IE9, but IE9 doesn’t support html5 file API. So I did a trik, I sent  base64 string of the image to server-side, server-side would generate a link to client-side, and then download it. The completed codes is<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$scope.exportToPNG = <span class="function"><span class="keyword">function</span> <span class="params">(chartId,scale)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> svgElement = d3.select(<span class="string">"#"</span> + chartId + <span class="string">" svg"</span>);</span><br><span class="line">    <span class="comment">//Append styles as there are some problems when drawing PNG on IE 9</span></span><br><span class="line">    _appendStylesToSVG(svgElement);</span><br><span class="line">    <span class="keyword">var</span> fileName = _buildPNGName(chartId);</span><br><span class="line">    scale = scale ? scale : <span class="number">1.5</span>;</span><br><span class="line"></span><br><span class="line">    saveAsSVGWithStyle(svgElement.node(), &#123;&#125;, <span class="function"><span class="keyword">function</span> <span class="params">(svgWithStyle, width, height)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>);</span><br><span class="line">        canvas.width = scale * width;</span><br><span class="line">            canvas.height = scale * height;</span><br><span class="line">            canvg(canvas, svgWithStyle, &#123; scaleWidth: canvas.width, scaleHeight: canvas.height, ignoreDimensions: <span class="literal">true</span>, ignoreMouse: <span class="literal">true</span>, ignoreClear: <span class="literal">true</span> &#125;);</span><br><span class="line">            <span class="keyword">var</span> imageData = canvas.toDataURL(<span class="string">"image/png"</span>);</span><br><span class="line">            imageData = imageData.replace(<span class="regexp">/^data:image\/(png|jpg);base64,/</span>, <span class="string">""</span>);</span><br><span class="line">            statisticalChartsService.saveChartCache(imageData).then(<span class="function"><span class="keyword">function</span> <span class="params">(response)</span> </span>&#123;</span><br><span class="line">                statisticalChartsService.getChartCache(fileName, response.data);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h2 id="Conclusion">Conclusion</h2><p>If you’d like to export SVG to PNG on the server-side, <strong>PhantomJs</strong> is a good choise. If you’d like to SVG to PNG on the client-side, you can use <strong>canvg</strong>.  But for <strong>nvd3</strong>, you have to figure out how to add external CSS class to SVG.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-03-26T18:00:47.000Z"><a href="/2015/03/26/fixes-some-bugs-for-ng-grid-reorderable/">2015-03-26</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/26/fixes-some-bugs-for-ng-grid-reorderable/">Fixes some bugs for ng-grid-reorderable</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://github.com/angular-ui/ng-grid/tree/2.x/plugins" target="_blank" rel="external">ng-grid-reorderable</a> is a drag-drop plugin for <a href="https://github.com/angular-ui/ng-grid" target="_blank" rel="external">ng-gird</a>. I found some bugs when I was using this plugin.</p>
<h3 id="Bug_1:_It_doesn’t_work_on_firefox">Bug 1: It doesn’t work on firefox</h3><p>The plugin use html5 drag-drop, firefox needs to set data for dataTransfer.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//set dataTransfer as it's required by firefox</span></span><br><span class="line">            <span class="keyword">var</span> onDragStart = <span class="function"><span class="keyword">function</span> <span class="params">(event)</span> </span>&#123;</span><br><span class="line">                event.originalEvent.dataTransfer.setData(<span class="string">"gridId"</span>, self.myGrid.gridId);</span><br><span class="line">            &#125;;</span><br></pre></td></tr></table></figure></p>
<h3 id="Bug_2:_Can_drag_a_row_to_the_other_ng-grid">Bug 2: Can drag a row to the other ng-grid</h3><p>To fix this bug, it needs to compare grid id on drop event.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> prevRow = self.services.DomUtilityService.eventStorage.rowToMove;</span><br><span class="line"><span class="keyword">if</span> (prevRow.gridId != self.myGrid.gridId) <span class="keyword">return</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="Bug_3:_Can’t_select_all_texts_when_at_edting_status">Bug 3: Can’t select all texts when at edting status</h3><p>To fix this bug, it needs to disable drag-drop feature.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//It should disable drag/drop feature when editing</span></span><br><span class="line">rowScope.$on(<span class="string">'ngGridEventStartCellEdit'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    targetRow.attr(<span class="string">'draggable'</span>, <span class="string">'false'</span>);</span><br><span class="line">    targetRow.off(<span class="string">'dragstart'</span>, onDragStart);</span><br><span class="line">&#125;);</span><br><span class="line">rowScope.$on(<span class="string">'ngGridEventEndCellEdit'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    targetRow.attr(<span class="string">'draggable'</span>, <span class="string">'true'</span>);</span><br><span class="line">    targetRow.on(<span class="string">'dragstart'</span>, onDragStart);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="Bug_4:_Can_select_some_texts_and_then_drag_and_drop_it_on_the_ng-gird">Bug 4: Can select some texts and then drag and drop it on the ng-gird</h3><p>To fix this bug, it needs to remove dragover and drop event for the $viewport when editing<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rowScope.$on(<span class="string">'ngGridEventStartCellEdit'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    self.myGrid.$viewport.off(<span class="string">'dragover'</span>, self.dragOver).off(<span class="string">'drop'</span>, self.onRowDrop);</span><br><span class="line">&#125;);</span><br><span class="line">rowScope.$on(<span class="string">'ngGridEventEndCellEdit'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    self.myGrid.$viewport.on(<span class="string">'dragover'</span>, self.dragOver).on(<span class="string">'drop'</span>, self.onRowDrop);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="The_codes_in_gist">The codes in gist</h3><script src="//gist.github.com/a77d1507f0e65c0e2908.js?file=ng-grid-reorderable.js"></script>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="photo">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-03-24T17:39:06.000Z"><a href="/2015/03/24/nvd3-nice-scale/">2015-03-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/24/nvd3-nice-scale/">nvd3中计算坐标轴的nice domain</a></h1>
  

    </header>
    <div class="entry">
      
        <p>最近用<a href="https://github.com/novus/nvd3" target="_blank" rel="external">nvd3</a>以及<a href="https://github.com/angularjs-nvd3-directives/angularjs-nvd3-directives" target="_blank" rel="external">angularjs-nvd3-directives</a>做chart遇到一个问题，如下图，y轴中的最大值是3.8。nvd3只会在坐标轴显示到数据最大值，但是有些情况下最大值并不是很好看，我们需要在这种情况下显示4.0。<br><img src="/2015/03/24/nvd3-nice-scale/nvd3_axis_1.png"><br>最开始查了下d3的文档，发现有个<a href="https://github.com/mbostock/d3/wiki/Quantitative-Scales" target="_blank" rel="external">nice()</a>方法可能会做到，但是尝试了下，不生效。查了下，可能是nvd3的<a href="https://github.com/novus/nvd3/issues/594" target="_blank" rel="external">bug</a>。要控制坐标轴的显示还可以通过xDomain(),yDomain()来实现，关键问题是如何计算domain的nice值。</p>
<h3 id="计算数据中的最小值，最大值">计算数据中的最小值，最大值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> yAxisValues = [<span class="number">1</span>,<span class="number">2.4</span>,<span class="number">3.6</span>,<span class="number">7.8</span>,<span class="number">9.2</span>];</span><br><span class="line"><span class="keyword">var</span> yAxisMax = d3.max(yAxisValues)</span><br><span class="line"><span class="keyword">var</span> yAxisMin= d3.min(yAxisValues)</span><br></pre></td></tr></table></figure>
<p>我们可以通过d3中提供的max方法得到数据中的最小值，最大值</p>
<h3 id="根据给定的最小值和最大值计算出nice值">根据给定的最小值和最大值计算出nice值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">app.factory(<span class="string">'niceScale'</span>, [<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> factory = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">///  Returns a "nice" number approximately equal to range Rounds</span></span><br><span class="line">        <span class="comment">///  the number if round = true Takes the ceiling if round = false.</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name="range"&gt;the minimum data point on the axis&lt;/param&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name="round"&gt;the maximum data point on the axis&lt;/param&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">niceNum</span><span class="params">(range, round)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// exponent of range</span></span><br><span class="line">            <span class="keyword">var</span> exponent;</span><br><span class="line">            <span class="comment">// fractional part of range</span></span><br><span class="line">            <span class="keyword">var</span> fraction;</span><br><span class="line">            <span class="comment">// nice, rounded fraction</span></span><br><span class="line">            <span class="keyword">var</span> niceFraction;</span><br><span class="line">            exponent = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.log10(range));</span><br><span class="line">            fraction = range / <span class="built_in">Math</span>.pow(<span class="number">10</span>, exponent);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (round) &#123;</span><br><span class="line">                <span class="keyword">if</span> (fraction &lt; <span class="number">1.5</span>) niceFraction = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (fraction &lt; <span class="number">3</span>) niceFraction = <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (fraction &lt; <span class="number">7</span>) niceFraction = <span class="number">5</span>;</span><br><span class="line">                <span class="keyword">else</span> niceFraction = <span class="number">10</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (fraction &lt;= <span class="number">1</span>) niceFraction = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (fraction &lt;= <span class="number">2</span>) niceFraction = <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (fraction &lt;= <span class="number">5</span>) niceFraction = <span class="number">5</span>;</span><br><span class="line">                <span class="keyword">else</span> niceFraction = <span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> niceFraction * <span class="built_in">Math</span>.pow(<span class="number">10</span>, exponent);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        factory.calculate = <span class="function"><span class="keyword">function</span> <span class="params">(min, max, maxTicks)</span> </span>&#123;</span><br><span class="line">            maxTicks = maxTicks ? maxTicks : <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">var</span> range = niceNum(max - min, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">var</span> tickSpacing = niceNum(range / (maxTicks - <span class="number">1</span>), <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">var</span> niceMin = <span class="built_in">Math</span>.floor(min / tickSpacing) * tickSpacing;</span><br><span class="line">            <span class="keyword">var</span> niceMax = <span class="built_in">Math</span>.ceil(max / tickSpacing) * tickSpacing;</span><br><span class="line">            <span class="keyword">return</span> [niceMin, niceMax];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    &#125;]);</span><br></pre></td></tr></table></figure>
<p>上面定义了一个angular中的service用来处理算法</p>
<h3 id="设置chart的domain">设置chart的domain</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chart.yDomain([niceMin,niceMax]);</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-03-23T16:26:19.000Z"><a href="/2015/03/23/ESL-1088-Selling-a-Business/">2015-03-23</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/23/ESL-1088-Selling-a-Business/">ESL_1088 Selling a Business</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="1-_sell_up">1. sell up</h3><p>为还债而变卖；卖完<br><em>I can’t belive you’re really selling up</em></p>
<h3 id="2-_stick_out">2. stick out</h3><p>突出；坚持；醒目<br><em>I thought you would stick it out for another year</em></p>
<h3 id="3-_count_on">3. count on</h3><p>指望；依靠<br><em>Count on me.</em></p>
<h3 id="4-_sweeten_the_pot">4. sweeten the pot</h3><p>增加有利条件；增加利诱成本；增加赌注，冒更大的险<br><em>I plan to sweeten the pot by offering my consulting service as part of the deal.</em></p>
<h3 id="5-_go_over">5. go over</h3><p>复习，重温；仔细检查；转变；润色<br><em>go over the <strong>books</strong></em><br>The “books” means the financial statement and something like that here.</p>
<h3 id="6-_jump-start">6. jump-start</h3><h3 id="7-_clause">7. clause</h3><p>n. 条款；[计] 子句<br><em>Non-compete clause</em> </p>
<h3 id="8-_try_my_hand">8. try my hand</h3><p>To attempt to do something for the first time<br><em>I tried my hand at skiing.</em><br><em>I might try my hand at something entirely differently.</em></p>
<h3 id="9-_Business_has_been_slow_for_three_years_running">9. Business has been slow for three years running</h3>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-03-21T12:43:06.000Z"><a href="/2015/03/21/ESL-1087-Selecting-Window-Treatments/">2015-03-21</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/21/ESL-1087-Selecting-Window-Treatments/">ESL_1087 Selecting Window Treatments</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="1-_Window_treatment">1. Window treatment</h3><h3 id="2-_wooden_shutter">2. wooden shutter</h3><p>n. 快门；百叶窗；关闭物；遮板<br>vt. 为…装百叶窗；以百叶窗遮闭</p>
<h3 id="3-_blind">3. blind</h3><p>n. 掩饰，借口；百叶窗<br>adj. 盲目的；瞎的<br>vt. 使失明；使失去理智<br>adv. 盲目地；看不见地</p>
<h3 id="4-_curtain">4. curtain</h3><p>n. 幕；窗帘<br>vt. 遮蔽；装上门帘</p>
<h3 id="5-_slat">5. slat</h3><p>vt. 用板条做或装备；用条板制造<br>n. 板条；狭板</p>
<h3 id="6-_rod">6. rod</h3><p>n. 棒；惩罚；枝条；权力</p>
<h3 id="7-decor">7.decor</h3><p>n. 装饰，布置</p>
<h3 id="8-_fabric">8. fabric</h3><p>n. 织物；布；构造；（建筑物的）结构（如墙、地面、屋顶）：质地</p>
<h3 id="9-_valance">9. valance</h3><p>n. （床架、窗户上部的）短帷幔</p>
<h3 id="10-_nail">10. nail</h3><p>n. 钉子；指甲，趾甲；钉状物；纳尔<br>vt. 钉住；抓住；使固定；揭露</p>
<h3 id="11-_What_is_the_difference_between_blinds_and_shutters?">11. What is the difference between blinds and shutters?</h3><p>Blinds are on the inside and shutters are on the outside. Shutters (when real,<br>not the fake ones) close to protect the windows from the elements when<br>you’re away from home, or during a storm. Blinds protect your privacy when<br>you’re inside and don’t wish to be on display to the neighbors.</p>
<h3 id="shutter,shuttle,shadow_pronunciation_difference"><em>shutter</em>,<em>shuttle</em>,<em>shadow</em> pronunciation difference</h3>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-04-30T06:41:35.000Z"><a href="/2014/04/30/git-operation/">2014-04-30</a></time>
      
      
  
    <h1 class="title"><a href="/2014/04/30/git-operation/">git常用操作</a></h1>
  

    </header>
    <div class="entry">
      
        <p>这里是一些自己经常用到的git命令</p>
<h2 id="git_全局配置">git 全局配置</h2><h4 id="配置全局user">配置全局user</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global user<span class="class">.name</span> <span class="string">"Your Name"</span></span><br></pre></td></tr></table></figure>
<h4 id="配置全局Email">配置全局Email</h4><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="built_in">global</span> user.email your.email<span class="property">@example</span>.com</span><br></pre></td></tr></table></figure>
<h4 id="配置别名">配置别名</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="keyword">global</span> alias.<span class="keyword">co</span> checkout   </span><br><span class="line">这里<span class="keyword">co</span> 代替字数较多的 checkout 命令</span><br></pre></td></tr></table></figure>
<h4 id="配置默认编辑器">配置默认编辑器</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.editor <span class="string">"subl -w"</span>  </span><br><span class="line">这里设置的是sublime,</span><br><span class="line">如果使用其他编辑器，请使用以下代码替换 subl -w：TextMate 用 mate -w，gVim 用 gvim <span class="operator">-f</span>，MacVim 用 mvim <span class="operator">-f</span></span><br></pre></td></tr></table></figure>
<h2 id="git_本地操作">git 本地操作</h2><h4 id="初始化项目">初始化项目</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">git</span> init</span><br></pre></td></tr></table></figure>
<h4 id="加入文件">加入文件</h4><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span></span><br></pre></td></tr></table></figure>
<h4 id="加入所有文件">加入所有文件</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">add</span> <span class="comment">--all</span></span><br></pre></td></tr></table></figure>
<h4 id="提交变更">提交变更</h4><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git commit -<span class="literal">a</span>  -m <span class="string">"comments"</span>   </span><br><span class="line">-<span class="literal">a</span>表示提交所有更改</span><br></pre></td></tr></table></figure>
<h4 id="创建并且切换到一个分支">创建并且切换到一个分支</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout -<span class="tag">b</span> modify-README  </span><br><span class="line">创建一个新分支modify-README，然后切换到这个分支</span><br></pre></td></tr></table></figure>
<h4 id="切换到分支">切换到分支</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">git</span> checkout master   </span><br><span class="line">切换到分支master</span><br></pre></td></tr></table></figure>
<h4 id="revert文件">revert文件</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout <span class="comment">-- file  </span></span><br><span class="line">把文件<span class="type">file</span>恢复到当前head版本</span><br></pre></td></tr></table></figure>
<h4 id="撤销所有更改">撤销所有更改</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout <span class="operator">-f</span>  </span><br><span class="line"><span class="operator">-f</span> 意思是覆盖当前的改动</span><br></pre></td></tr></table></figure>
<h4 id="显示所有分支">显示所有分支</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">git</span> branch</span><br></pre></td></tr></table></figure>
<h4 id="删除分支">删除分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git branch <span class="operator">-d</span> modify-README    </span><br><span class="line"> 删除分支modify-README</span><br></pre></td></tr></table></figure>
<h4 id="删除所有分支">删除所有分支</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -<span class="keyword">D</span></span><br></pre></td></tr></table></figure>
<h4 id="显示比较差异">显示比较差异</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">git</span> diff</span><br></pre></td></tr></table></figure>
<h4 id="显示当前状态">显示当前状态</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">git</span> status</span><br></pre></td></tr></table></figure>
<h4 id="显示日志">显示日志</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="command">log</span>  </span><br><span class="line">q退出</span><br></pre></td></tr></table></figure>
<h2 id="git_remote仓库操作">git remote仓库操作</h2><h4 id="加入远程仓库">加入远程仓库</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@github<span class="class">.com</span>:username/first_app<span class="class">.git</span>     </span><br><span class="line">origin为自定义的远程仓库名称   </span><br><span class="line">git@github<span class="class">.com</span>:username/first_app<span class="class">.git</span> 为远程git地址</span><br></pre></td></tr></table></figure>
<h4 id="提交远程仓库">提交远程仓库</h4><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">push</span> origin master  </span><br><span class="line">origin为远程仓库名称   </span><br><span class="line">master为项目分支</span><br></pre></td></tr></table></figure>
<h4 id="显示当前remote仓库列表">显示当前remote仓库列表</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">git</span> remote</span><br></pre></td></tr></table></figure>
<h4 id="删除一个remote仓库列表">删除一个remote仓库列表</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote remove <span class="property">name</span></span><br></pre></td></tr></table></figure>
<h4 id="从远程仓库更新并且合并">从远程仓库更新并且合并</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">git</span> pull</span><br></pre></td></tr></table></figure>
<h4 id="从远程仓库更新">从远程仓库更新</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">git</span> fetch</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/NET/">.NET</a><small>1</small></li>
  
    <li><a href="/categories/English/">English</a><small>4</small></li>
  
    <li><a href="/categories/git/">git</a><small>1</small></li>
  
    <li><a href="/categories/javascript/">javascript</a><small>4</small></li>
  
    <li><a href="/categories/shell/">shell</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/ESL/">ESL</a><small>4</small></li>
  
    <li><a href="/tags/OWIN/">OWIN</a><small>1</small></li>
  
    <li><a href="/tags/angularjs/">angularjs</a><small>4</small></li>
  
    <li><a href="/tags/canvg/">canvg</a><small>1</small></li>
  
    <li><a href="/tags/chart/">chart</a><small>2</small></li>
  
    <li><a href="/tags/d3/">d3</a><small>2</small></li>
  
    <li><a href="/tags/git/">git</a><small>1</small></li>
  
    <li><a href="/tags/mac/">mac</a><small>1</small></li>
  
    <li><a href="/tags/ng-gird/">ng-gird</a><small>1</small></li>
  
    <li><a href="/tags/nvd3/">nvd3</a><small>2</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>2</small></li>
  
    <li><a href="/tags/ssh/">ssh</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Hui
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'dixon629githubio';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>