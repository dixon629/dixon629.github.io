<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>How to make dependent drop-down list in Excel through Apache POI | Hui&#39;s blog</title>
  <meta name="author" content="Hui">
  
  <meta name="description" content="In some situation, we need to use dependent drop-down list in Excel. For example, there’re two drop-down list, parent cateogory list and subcategory l">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="How to make dependent drop-down list in Excel through Apache POI"/>
  <meta property="og:site_name" content="Hui&#39;s blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Hui&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Hui&#39;s blog</a></h1>
  <h2><a href="/">Make progress a little bit every day</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/resume.html">Resume</a></li>
    
      <li><a href="/resume.cn.html">中文简历</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-25T06:45:56.000Z"><a href="/2015/04/25/How-to-make-dependent-drop-down-list-through-Apache-POI/">2015-04-25</a></time>
      
      
  
    <h1 class="title">How to make dependent drop-down list in Excel through Apache POI</h1>
  

    </header>
    <div class="entry">
      
        <p>In some situation, we need to use dependent drop-down list in Excel. For example, there’re two drop-down list, parent cateogory list and subcategory list. The subcategory list depends on which item parent selected. How to make it through <a href="https://poi.apache.org/" target="_blank" rel="external">Apache POI</a>?<br>First, we need to figure out how to make it in Excel. We can use function <strong>INDIRECT</strong> and <strong>VLOOkUP</strong> to achieve it. <a href="http://www.contextures.com/xlDataVal02.html" target="_blank" rel="external">Create Dependent Drop Down Lists</a> is a good tutorial to show you how to do it in Excel.<br>Then, we need to figure out how to build this formula in POI. We can’t set the explicit validation list as the list is from database and can be populated.<br>So we need to generate the parent list and subcategory list in sepecified column first. When we create the subcategory list, we need to add extra field to indicate which parent it belongs. Something likes this in Excel.</p>
<table>
<thead>
<tr>
<th>Parent Category</th>
<th></th>
<th>SubCateogry</th>
<th>Belongs</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Parent A</td>
<td></td>
<td>Sub A</td>
<td>Parent A</td>
<td></td>
</tr>
<tr>
<td>Parent B</td>
<td></td>
<td>Sub B</td>
<td>Parent A</td>
<td></td>
</tr>
<tr>
<td>Parent C</td>
<td></td>
<td>Sub C</td>
<td>Parent B</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Sub D</td>
<td>Parent C</td>
</tr>
</tbody>
</table>
<p>For parent list, we create drop-down list directly. For example,<br><strong><em>dvConstraint = DVConstraint.createFormulaListConstraint(“$A$1:$A$3”);</em></strong><br>It will set validation list from A1 to A3.<br>When you select “Parent A”, we need to look up the subcategoires belongs to it.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String searchTable = <span class="string">"$"</span> + sublcategoryCol + <span class="string">"$"</span> + (rowStart + <span class="number">1</span>) + <span class="string">":"</span> + <span class="string">"$"</span> + rangeCol + <span class="string">"$"</span> + (rowEnd + <span class="number">1</span>);</span><br><span class="line">String lookupValue = <span class="string">"$"</span> + valueCol + <span class="string">"$"</span> + (valueRowIndex + <span class="number">1</span>);</span><br><span class="line">String formula = <span class="string">"VLOOKUP("</span> + lookupValue + <span class="string">","</span> + searchTable + <span class="string">",2,FALSE)"</span>;</span><br></pre></td></tr></table></figure></p>
<p>The <em>searchTable</em> is a table range it will look up for the parent.<br>The <em>lookupValue</em> is the selected value of parent list.<br>After looking up the subcategories, we can use <strong>INDIRECT</strong> to add refrence for subcategory cell.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String formula = <span class="string">"INDIRECT("</span> + formula + <span class="string">")"</span>;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/Java/">Java</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/Apache-POI/">Apache POI</a>, <a href="/tags/EXCEL/">EXCEL</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">Comments</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://yoursite.com/2015/04/25/How-to-make-dependent-drop-down-list-through-Apache-POI/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/NET/">.NET</a><small>3</small></li>
  
    <li><a href="/categories/English/">English</a><small>4</small></li>
  
    <li><a href="/categories/Java/">Java</a><small>1</small></li>
  
    <li><a href="/categories/git/">git</a><small>1</small></li>
  
    <li><a href="/categories/javascript/">javascript</a><small>4</small></li>
  
    <li><a href="/categories/shell/">shell</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/Apache-POI/">Apache POI</a><small>1</small></li>
  
    <li><a href="/tags/ESL/">ESL</a><small>4</small></li>
  
    <li><a href="/tags/EXCEL/">EXCEL</a><small>1</small></li>
  
    <li><a href="/tags/OWIN/">OWIN</a><small>1</small></li>
  
    <li><a href="/tags/PDF/">PDF</a><small>1</small></li>
  
    <li><a href="/tags/Phantomjs/">Phantomjs</a><small>1</small></li>
  
    <li><a href="/tags/angularjs/">angularjs</a><small>4</small></li>
  
    <li><a href="/tags/canvg/">canvg</a><small>1</small></li>
  
    <li><a href="/tags/chart/">chart</a><small>2</small></li>
  
    <li><a href="/tags/d3/">d3</a><small>2</small></li>
  
    <li><a href="/tags/git/">git</a><small>1</small></li>
  
    <li><a href="/tags/itextsharp/">itextsharp</a><small>1</small></li>
  
    <li><a href="/tags/mac/">mac</a><small>1</small></li>
  
    <li><a href="/tags/ng-gird/">ng-gird</a><small>1</small></li>
  
    <li><a href="/tags/nvd3/">nvd3</a><small>2</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>2</small></li>
  
    <li><a href="/tags/ssh/">ssh</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 Hui
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'dixon629githubio';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
